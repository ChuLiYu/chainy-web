<!DOCTYPE html>
<html lang="zh-TW">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>éŸ¿æ‡‰å¼ Google ç™»éŒ„æ¸¬è©¦</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }

        h1 {
            text-align: center;
            color: #4285f4;
            margin-bottom: 30px;
        }

        .device-info {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            border-left: 4px solid #4285f4;
        }

        .test-section {
            margin: 20px 0;
            padding: 20px;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
        }

        .test-button {
            width: 100%;
            padding: 12px 16px;
            background: #4285f4;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            margin: 10px 0;
            transition: background 0.3s;
        }

        .test-button:hover {
            background: #3367d6;
        }

        .log {
            background: #f5f5f5;
            padding: 15px;
            border-radius: 8px;
            font-family: monospace;
            font-size: 12px;
            max-height: 200px;
            overflow-y: auto;
            white-space: pre-wrap;
        }

        .status {
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
        }

        .status.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .status.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .status.info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
    </style>
</head>

<body>
    <div class="container">
        <h1>ğŸš€ éŸ¿æ‡‰å¼ Google ç™»éŒ„æ¸¬è©¦</h1>

        <div class="device-info">
            <h3>ğŸ“± è¨­å‚™è³‡è¨Š</h3>
            <div id="device-info">æª¢æ¸¬ä¸­...</div>
        </div>

        <div class="test-section">
            <h3>ğŸ”§ Google Auth é…ç½®</h3>
            <div id="config-info">è¼‰å…¥ä¸­...</div>
        </div>

        <div class="test-section">
            <h3>ğŸ§ª æ¸¬è©¦åŠŸèƒ½</h3>
            <button class="test-button" onclick="testDeviceDetection()">æª¢æ¸¬è¨­å‚™é¡å‹</button>
            <button class="test-button" onclick="testGoogleAuthInit()">åˆå§‹åŒ– Google Auth</button>
            <button class="test-button" onclick="testGoogleLogin()">è§¸ç™¼ Google ç™»éŒ„</button>
            <button class="test-button" onclick="clearLog()">æ¸…é™¤æ—¥èªŒ</button>
        </div>

        <div class="test-section">
            <h3>ğŸ“Š æ¸¬è©¦çµæœ</h3>
            <div id="status"></div>
            <div id="log" class="log"></div>
        </div>
    </div>

    <script>
        // æ¨¡æ“¬ googleAuth.js çš„åŠŸèƒ½
        const GOOGLE_CLIENT_ID = '1079648073253-kueo7mpri415h10dsc0fldeoecp878l6.apps.googleusercontent.com';

        function log(message, type = 'info') {
            const logElement = document.getElementById('log');
            const timestamp = new Date().toLocaleTimeString();
            logElement.textContent += `[${timestamp}] ${message}\n`;
            logElement.scrollTop = logElement.scrollHeight;

            // æ›´æ–°ç‹€æ…‹
            const statusElement = document.getElementById('status');
            statusElement.innerHTML = `<div class="status ${type}">${message}</div>`;
        }

        function getDeviceType() {
            const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
            const isTablet = /iPad|Android/i.test(navigator.userAgent) && window.innerWidth >= 768;
            const isDesktop = !isMobile && !isTablet;

            return { isMobile, isTablet, isDesktop };
        }

        function getOptimalUxMode() {
            const { isMobile, isTablet } = getDeviceType();
            return (isMobile || isTablet) ? 'redirect' : 'popup';
        }

        function getButtonConfig() {
            const { isMobile } = getDeviceType();

            return {
                theme: 'outline',
                size: 'large',
                text: 'signin_with',
                shape: 'rectangular',
                width: '100%',
                logo_alignment: 'left'
            };
        }

        function testDeviceDetection() {
            const deviceType = getDeviceType();
            const uxMode = getOptimalUxMode();
            const buttonConfig = getButtonConfig();

            log(`è¨­å‚™æª¢æ¸¬çµæœ:`, 'info');
            log(`- ç§»å‹•ç«¯: ${deviceType.isMobile}`, 'info');
            log(`- å¹³æ¿: ${deviceType.isTablet}`, 'info');
            log(`- æ¡Œé¢ç«¯: ${deviceType.isDesktop}`, 'info');
            log(`- è¢å¹•å¯¬åº¦: ${window.innerWidth}px`, 'info');
            log(`- å»ºè­°UXæ¨¡å¼: ${uxMode}`, 'info');
            log(`- æŒ‰éˆ•é…ç½®: ${JSON.stringify(buttonConfig)}`, 'info');

            // æ›´æ–°è¨­å‚™è³‡è¨Šé¡¯ç¤º
            document.getElementById('device-info').innerHTML = `
                <strong>è¨­å‚™é¡å‹:</strong> ${deviceType.isMobile ? 'ç§»å‹•ç«¯' : deviceType.isTablet ? 'å¹³æ¿' : 'æ¡Œé¢ç«¯'}<br>
                <strong>è¢å¹•å¯¬åº¦:</strong> ${window.innerWidth}px<br>
                <strong>å»ºè­°UXæ¨¡å¼:</strong> ${uxMode}<br>
                <strong>User Agent:</strong> ${navigator.userAgent.substring(0, 50)}...
            `;
        }

        function testGoogleAuthInit() {
            log('é–‹å§‹åˆå§‹åŒ– Google Auth...', 'info');

            if (!GOOGLE_CLIENT_ID) {
                log('âŒ Google Client ID æœªé…ç½®', 'error');
                return;
            }

            const uxMode = getOptimalUxMode();
            const deviceType = getDeviceType();

            log(`âœ… Client ID: ${GOOGLE_CLIENT_ID}`, 'success');
            log(`âœ… è¨­å‚™é¡å‹: ${JSON.stringify(deviceType)}`, 'success');
            log(`âœ… UXæ¨¡å¼: ${uxMode}`, 'success');

            const config = {
                client_id: GOOGLE_CLIENT_ID,
                callback: 'handleGoogleResponse',
                auto_select: false,
                cancel_on_tap_outside: true,
                use_fedcm_for_prompt: false,
                ux_mode: uxMode
            };

            if (uxMode === 'redirect') {
                config.redirect_uri = 'http://localhost:3000/callback';
            }

            log(`âœ… é…ç½®: ${JSON.stringify(config, null, 2)}`, 'success');

            // æ›´æ–°é…ç½®è³‡è¨Š
            document.getElementById('config-info').innerHTML = `
                <strong>Client ID:</strong> ${GOOGLE_CLIENT_ID}<br>
                <strong>UXæ¨¡å¼:</strong> ${uxMode}<br>
                <strong>é‡å®šå‘URI:</strong> ${uxMode === 'redirect' ? 'http://localhost:3000/callback' : 'ç„¡'}<br>
                <strong>é…ç½®ç‹€æ…‹:</strong> <span style="color: green;">âœ… å°±ç·’</span>
            `;
        }

        function testGoogleLogin() {
            log('è§¸ç™¼ Google ç™»éŒ„æ¸¬è©¦...', 'info');

            const uxMode = getOptimalUxMode();
            log(`ä½¿ç”¨ ${uxMode} æ¨¡å¼`, 'info');

            if (uxMode === 'popup') {
                log('æ¡Œé¢ç«¯æ¨¡å¼: å˜—è©¦ One Tap å½ˆçª—', 'info');
                log('å¦‚æœ One Tap ä¸é¡¯ç¤ºï¼Œå°‡ä½¿ç”¨ Sign-In Button', 'info');
            } else {
                log('ç§»å‹•ç«¯æ¨¡å¼: å°‡é‡å®šå‘åˆ° Google æˆæ¬Šé é¢', 'info');
            }

            // æ¨¡æ“¬ç™»éŒ„æµç¨‹
            setTimeout(() => {
                log('âœ… Google ç™»éŒ„æµç¨‹å·²è§¸ç™¼', 'success');
                log('è«‹æª¢æŸ¥ç€è¦½å™¨æ˜¯å¦è·³è½‰åˆ° Google æˆæ¬Šé é¢', 'info');
            }, 1000);
        }

        function clearLog() {
            document.getElementById('log').textContent = '';
            document.getElementById('status').innerHTML = '';
        }

        // é é¢è¼‰å…¥æ™‚è‡ªå‹•æª¢æ¸¬
        window.onload = function () {
            testDeviceDetection();
            testGoogleAuthInit();
            log('ğŸš€ éŸ¿æ‡‰å¼ Google ç™»éŒ„æ¸¬è©¦é é¢å·²è¼‰å…¥', 'success');
        };

        // è™•ç† Google ç™»éŒ„å›æ‡‰
        function handleGoogleResponse(response) {
            log('æ”¶åˆ° Google ç™»éŒ„å›æ‡‰:', 'success');
            log(`å›æ‡‰: ${JSON.stringify(response)}`, 'info');
        }

        // ç›£è½è¦–çª—å¤§å°è®ŠåŒ–
        window.addEventListener('resize', function () {
            log(`è¦–çª—å¤§å°è®ŠåŒ–: ${window.innerWidth}x${window.innerHeight}`, 'info');
            testDeviceDetection();
        });
    </script>
</body>

</html>
